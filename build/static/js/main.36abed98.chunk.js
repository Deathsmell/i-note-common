(this["webpackJsonpi-note-common"]=this["webpackJsonpi-note-common"]||[]).push([[0],{136:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),a=n(19),i=n.n(a),r=(n(55),n(56),n(4)),u=n(49),l=n(10),s=n(48),f=function(){return{updateNote:function(e,t){var n=t.id,o=t.width,c=t.height,a=t.x,i=t.y,r=t.color,u=t.text,l=t.type;return"string"===typeof o&&(o=o.replace(/px$/,"")),"string"===typeof c&&(c=c.replace(/px$/,"")),{id:n||e.id,width:o||e.width,height:c||e.height,x:~a?a:e.x,y:~i?i:e.y,color:r||e.color,text:u||e.text||" ",type:l||null}},defaultNote:{id:null,text:"",width:200,height:200,x:0,y:0,type:"",color:""},isEqual:function(e,t){return e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y&&e.color===t.color&&e.text===t.text}}},d="create",b="update",h="delete",p=n(47),y=n.n(p),m=function(e){var t=e.focus,n=e.setFocus,a=e.note,i=e.color,d=e.noteIndex,p=e.notes,m=e.setNotes,x=e.connection,g=Object(o.useState)(!1),v=Object(r.a)(g,2),O=v[0],j=v[1],w=Object(o.useState)(1),E=Object(r.a)(w,2),N=E[0],k=E[1],C=Object(o.useState)(a.text),S=Object(r.a)(C,2),I=S[0],J=S[1],z=f(),D=z.updateNote,F=z.isEqual;Object(o.useEffect)((function(){return k(0),function(){k(0)}}),[]),Object(o.useEffect)((function(){k(t?1:0)}),[t]);var $=function(e){m((function(){return[].concat(Object(l.a)(p.filter((function(t){return t.id!==e.id}))),[e])}))},q=function(e,t){return x.send(JSON.stringify(Object(u.a)({},t,{type:e})))},A=function(e){var t=e.target.value;if(t!==i){console.log("update color");var n=D(a,{color:t});$(n),q(b,n)}};return Object(o.useEffect)((function(){if(!O){var e=D(a,{text:I});$(e),q(b,e)}}),[O]),c.a.createElement(s.a,{className:"note",disableDragging:t,style:{zIndex:N},size:{width:p[d].width,height:p[d].height},minWidth:250,minHeight:250,position:{x:p[d].x,y:p[d].y},onDragStop:function(e,t){if(a.x!==t.x&&t.y!==a.y){var n=D(a,{x:t.x,y:t.y});q(b,n),$(n)}},onResizeStop:function(e,t,n,o,c){var i=D(a,{width:n.style.width,height:n.style.height,x:c.x,y:c.y});F(a,i)||($(i),q(b,i))},bounds:"window"},c.a.createElement("div",{className:"note-header",style:{backgroundColor:i||"gold"},onClick:function(){return k(1)},onMouseLeave:function(){return k(0)}},c.a.createElement("div",{className:"color-buttons"},c.a.createElement("button",{className:"btn blue",value:"blue",onClick:A}),c.a.createElement("button",{className:"btn pink",value:"pink",onClick:A}),c.a.createElement("button",{className:"btn yellow",value:"yellow",onClick:A})),c.a.createElement("div",{className:"cross",onClick:function(){q(h,a),m((function(e){return Object(l.a)(e.filter((function(e){return e.id!==a.id})))}))}},"\xd7")),O?c.a.createElement("textarea",{className:"note-text",value:I,onChange:function(e){var t=e.target.value;J(t)},autoFocus:!0,onBlur:function(){j(!1),n(!1)}}):c.a.createElement("div",{id:"preview",className:"note-body",onClick:function(){j(!0),n(!0)}},c.a.createElement(y.a,null,I)))},x=function(e,t){var n=Object(o.useState)(null),c=Object(r.a)(n,2),a=c[0],i=c[1],u=Object(o.useCallback)((function(e){t((function(t){return[].concat(Object(l.a)(t.filter((function(t){return t.id!==e.id}))),[e])}))}),[t]),s=Object(o.useCallback)((function(e,n){switch(n){case d:case b:return u(e);case h:return t((function(t){return Object(l.a)(t.filter((function(t){return t.id!==e.id})))}));default:Array.isArray(e)?t((function(){return e})):console.error("Incorrect data message",n,e)}}),[t,u]),f=Object(o.useCallback)((function(e){var t=e.data;if(t){var n=JSON.parse(t);s(n,n.type)}}),[s]),p=function(){console.log("connected")};return Object(o.useEffect)((function(){if(null===a){var e=window.location.href.replace(/^http/,"ws").replace(/3000\/$/,"5000/");console.log(e);var t=new WebSocket(e);t.onmessage=f,t.onopen=p,i(t)}}),[a,f]),{connection:a}},g=function(){var e=f(),t=e.defaultNote,n=e.updateNote,a=Object(o.useState)([]),i=Object(r.a)(a,2),u=i[0],l=i[1],s=Object(o.useState)(!1),b=Object(r.a)(s,2),h=b[0],p=b[1],y=x(u,l).connection;return c.a.createElement("div",{className:"workspace",onDoubleClick:function(e){if(!h){var o=n(t,{x:e.clientX,y:e.clientY,type:d});y.send(JSON.stringify(o))}}},u&&u.map((function(e,t){return c.a.createElement(m,{key:e.id,noteIndex:t,note:e,notes:u,focus:h,setFocus:p,setNotes:l,connection:y,color:e.color})})))};i.a.render(c.a.createElement(g,null),document.getElementById("root"))},50:function(e,t,n){e.exports=n(136)},55:function(e,t,n){}},[[50,1,2]]]);
//# sourceMappingURL=main.36abed98.chunk.js.map