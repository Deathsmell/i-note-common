{"ast":null,"code":"var _jsxFileName = \"/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Rnd } from \"react-rnd\";\nconst style = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  border: \"solid 1px #ddd\",\n  background: \"#f0f0f0\"\n};\n\nconst Note = ({\n  getFromLocal,\n  saveInLocal,\n  index,\n  state,\n  setState\n}) => {\n  const [note, setNote] = useState(state[index]);\n  useEffect(() => {\n    setNote(state[index]);\n  }, [state]);\n  const [transformNote, setTransformNote] = useState(false);\n  const [text, setText] = useState('');\n  const rnd = useRef();\n\n  const updateState = (weigh, height, x, y) => {\n    let newState = [...state];\n    newState[index] = {\n      weigh: weigh || note.weigh,\n      height: height || note.height,\n      x: ~x ? x : note.x,\n      y: ~y ? y : note.y\n    };\n    return newState;\n  };\n\n  const savePositionWhenTransformation = () => {\n    if (transformNote && (state[index].x !== 0 || state[index].y !== 0)) {\n      saveInLocal(index, { ...note,\n        x: state[index].x,\n        y: state[index].y\n      });\n      console.log(\"save position\", index);\n      setState(updateState(null, null, 0, 0));\n    } else {\n      console.log(\"get position\", index);\n      const stringPosition = getFromLocal(index);\n\n      if (stringPosition) {\n        setState(updateState(JSON.parse(stringPosition)));\n      }\n    }\n  };\n\n  useEffect(savePositionWhenTransformation, [transformNote]);\n\n  const onDragStopHandler = (event, data) => {\n    console.log(\"on drag stop\", index);\n    const newState = updateState(null, null, data.x, data.y);\n    saveInLocal(index, newState[index]);\n    setState(newState);\n  };\n\n  const onResizeStopHandler = (e, direction, ref, delta, position) => {\n    console.log(\"resize\");\n    setState(updateState(ref.style.width, ref.style.height, position.x, position.y));\n  };\n\n  return /*#__PURE__*/React.createElement(Rnd, {\n    ref: rnd,\n    className: `note${transformNote ? '-activate' : ''}`,\n    disableDragging: transformNote,\n    style: { ...style\n    },\n    size: {\n      width: note.width,\n      height: note.height\n    },\n    minWidth: 250,\n    minHeight: 250,\n    position: {\n      x: note.x,\n      y: note.y\n    },\n    onDragStop: onDragStopHandler,\n    onResizeStop: onResizeStopHandler,\n    bounds: \"window\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"color-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cross\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }, \"\\xD7\")), transformNote ? /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"note-text\",\n    style: {\n      resize: 'none',\n      backgroundColor: \"grey\",\n      width: '100%',\n      height: \"100%\"\n    },\n    value: text,\n    onChange: e => setText(e.target.value),\n    onDoubleClick: () => setTransformNote(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-body\",\n    style: {\n      backgroundColor: 'grey'\n    },\n    onDoubleClick: () => setTransformNote(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 25\n    }\n  }, text));\n};\n\nexport default Note;","map":{"version":3,"sources":["/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.js"],"names":["React","useEffect","useRef","useState","Rnd","style","display","alignItems","justifyContent","border","background","Note","getFromLocal","saveInLocal","index","state","setState","note","setNote","transformNote","setTransformNote","text","setText","rnd","updateState","weigh","height","x","y","newState","savePositionWhenTransformation","console","log","stringPosition","JSON","parse","onDragStopHandler","event","data","onResizeStopHandler","e","direction","ref","delta","position","width","resize","backgroundColor","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\"\nimport {Rnd} from \"react-rnd\"\n\nconst style = {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    border: \"solid 1px #ddd\",\n    background: \"#f0f0f0\",\n};\n\nconst Note = ({getFromLocal, saveInLocal, index, state, setState}) => {\n\n    const [note, setNote] = useState(state[index]);\n\n    useEffect(() => {\n        setNote(state[index])\n    }, [state])\n\n    const [transformNote, setTransformNote] = useState(false);\n    const [text, setText] = useState('');\n    const rnd = useRef();\n\n    const updateState = (weigh,height,x,y) => {\n        let newState = [...state]\n        newState[index] = {\n            weigh: weigh || note.weigh,\n            height: height || note.height,\n            x: ~x ? x : note.x,\n            y: ~y ? y : note.y,\n        }\n        return newState\n    }\n\n    const savePositionWhenTransformation = () => {\n        if (transformNote && (state[index].x !== 0 || state[index].y !== 0)) {\n            saveInLocal(index, {...note, x: state[index].x, y: state[index].y});\n            console.log(\"save position\", index)\n            setState(updateState(null,null,0,0))\n        } else {\n            console.log(\"get position\", index)\n            const stringPosition = getFromLocal(index)\n            if (stringPosition) {\n                setState(updateState(JSON.parse(stringPosition)))\n            }\n        }\n    };\n\n    useEffect(savePositionWhenTransformation, [transformNote])\n\n\n    const onDragStopHandler = (event, data) => {\n        console.log(\"on drag stop\", index)\n        const newState = updateState(null,null,data.x,data.y);\n        saveInLocal(index, newState[index])\n        setState(newState)\n    }\n\n    const onResizeStopHandler = (e, direction, ref, delta, position) => {\n        console.log(\"resize\")\n        setState(updateState(ref.style.width, ref.style.height,position.x, position.y));\n    }\n\n    return (\n        <Rnd\n            ref={rnd}\n            className={`note${transformNote ? '-activate' : ''}`}\n            disableDragging={transformNote}\n            style={{...style}}\n            size={{width: note.width, height: note.height}}\n            minWidth={250}\n            minHeight={250}\n            position={{x: note.x, y: note.y}}\n            onDragStop={onDragStopHandler}\n            onResizeStop={onResizeStopHandler}\n            bounds={\"window\"}\n        >\n            <div className=\"note-header\">\n                <div className=\"color-buttons\">\n                    <button className=\"btn btn-success\"/>\n                    <button className=\"btn btn-danger\"/>\n                    <button className=\"btn btn-secondary\"/>\n                </div>\n                <div className=\"cross\">\n                    &times;\n                </div>\n            </div>\n            {\n                transformNote\n                    ?\n                    (\n                        <textarea\n                            className=\"note-text\"\n                            style={{resize: 'none', backgroundColor: \"grey\", width: '100%', height: \"100%\"}}\n                            value={text}\n                            onChange={(e) => setText(e.target.value)}\n                            onDoubleClick={() => setTransformNote(false)}\n                        >\n\n                            </textarea>\n                    )\n                    : (\n                        <div className=\"note-body\"\n                             style={{backgroundColor: 'grey'}}\n                             onDoubleClick={() => setTransformNote(true)}\n                        >\n                            {text}\n                        </div>\n                    )\n            }\n        </Rnd>\n    )\n}\n\nexport default Note"]},"metadata":{},"sourceType":"module"}