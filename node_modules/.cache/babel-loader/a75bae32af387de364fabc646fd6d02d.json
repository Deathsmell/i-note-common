{"ast":null,"code":"var _jsxFileName = \"/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.jsx\";\n\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState } from \"react\";\nimport { Rnd } from \"react-rnd\";\nimport useNote from \"../hooks/note.hook\";\nimport { TypeMessage } from \"../hooks/TypeMessage\";\nimport ReactMarkdown from 'react-markdown';\n\nconst Note = ({\n  focus,\n  setFocus,\n  note,\n  color,\n  noteIndex,\n  notes,\n  setNotes,\n  connection\n}) => {\n  const [changed, setChanged] = useState(false);\n  const [zIndex, setZIndex] = useState(1);\n  const [text, setText] = useState(note.text);\n  const {\n    updateNote,\n    isEqual\n  } = useNote();\n  useEffect(function resetZIndex() {\n    setZIndex(0);\n    return () => {\n      setZIndex(0);\n    };\n  }, []);\n  useEffect(function liftingComponent() {\n    if (focus) {\n      setZIndex(1);\n    } else {\n      setZIndex(0);\n    }\n  }, [focus]);\n\n  const updateStateNotes = updatedNote => {\n    setNotes(() => [...notes.filter(note => note.id !== updatedNote.id), updatedNote]);\n  };\n\n  const sendNewPosition = (type, note) => connection.send(JSON.stringify({ ...note,\n    type\n  }));\n\n  const onDragStopHandler = (event, data) => {\n    if (note.x !== data.x && data.y !== note.y) {\n      const updatedNote = updateNote(note, {\n        x: data.x,\n        y: data.y\n      });\n      sendNewPosition(TypeMessage.UPDATE, updatedNote);\n      updateStateNotes(updatedNote);\n    }\n  };\n\n  const onResizeStopHandler = (e, direction, ref, delta, position) => {\n    const updatedNote = updateNote(note, {\n      width: ref.style.width,\n      height: ref.style.height,\n      x: position.x,\n      y: position.y\n    });\n\n    if (!isEqual(note, updatedNote)) {\n      updateStateNotes(updatedNote);\n      sendNewPosition(TypeMessage.UPDATE, updatedNote);\n    }\n  };\n\n  const deleteNoteHandler = () => {\n    sendNewPosition(TypeMessage.DELETE, note);\n    setNotes(prev => [...prev.filter(noteFromState => noteFromState.id !== note.id)]);\n  };\n\n  const changeColorHandler = e => {\n    const changeColor = e.target.value;\n\n    if (changeColor !== color) {\n      console.log(\"update color\");\n      const updatedNote = updateNote(note, {\n        color: changeColor\n      });\n      updateStateNotes(updatedNote);\n      sendNewPosition(TypeMessage.UPDATE, updatedNote);\n    }\n  };\n\n  const changeTextHandler = e => {\n    const text = e.target.value;\n    setText(text);\n  };\n\n  useEffect(function saveChangeText() {\n    if (!changed) {\n      const updatedNote = updateNote(note, {\n        text\n      });\n      updateStateNotes(updatedNote);\n      sendNewPosition(TypeMessage.UPDATE, updatedNote);\n    }\n  }, [changed]);\n  return /*#__PURE__*/React.createElement(Rnd, {\n    className: \"note\",\n    disableDragging: focus,\n    style: {\n      zIndex: zIndex\n    },\n    size: {\n      width: notes[noteIndex].width,\n      height: notes[noteIndex].height\n    },\n    minWidth: 250,\n    minHeight: 250,\n    position: {\n      x: notes[noteIndex].x,\n      y: notes[noteIndex].y\n    },\n    onDragStop: onDragStopHandler,\n    onResizeStop: onResizeStopHandler,\n    bounds: \"window\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-header\",\n    style: {\n      backgroundColor: color || \"gold\"\n    },\n    onClick: () => setZIndex(1),\n    onMouseLeave: () => setZIndex(0),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"color-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn blue\",\n    value: \"blue\",\n    onClick: changeColorHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn pink\",\n    value: \"pink\",\n    onClick: changeColorHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn yellow\",\n    value: \"yellow\",\n    onClick: changeColorHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cross\",\n    onClick: deleteNoteHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }\n  }, \"\\xD7\")), changed ? /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"note-text\",\n    value: text,\n    onChange: changeTextHandler,\n    autoFocus: true,\n    onBlur: () => {\n      setChanged(false);\n      setFocus(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    id: \"preview\",\n    className: \"note-body\",\n    onClick: () => {\n      setChanged(true);\n      setFocus(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ReactMarkdown, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 29\n    }\n  }, text)));\n};\n\nexport default Note;","map":{"version":3,"sources":["/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.jsx"],"names":["React","useEffect","useState","Rnd","useNote","TypeMessage","ReactMarkdown","Note","focus","setFocus","note","color","noteIndex","notes","setNotes","connection","changed","setChanged","zIndex","setZIndex","text","setText","updateNote","isEqual","resetZIndex","liftingComponent","updateStateNotes","updatedNote","filter","id","sendNewPosition","type","send","JSON","stringify","onDragStopHandler","event","data","x","y","UPDATE","onResizeStopHandler","e","direction","ref","delta","position","width","style","height","deleteNoteHandler","DELETE","prev","noteFromState","changeColorHandler","changeColor","target","value","console","log","changeTextHandler","saveChangeText","backgroundColor"],"mappings":"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","sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport React, {useEffect, useState} from \"react\"\nimport {Rnd} from \"react-rnd\"\nimport useNote from \"../hooks/note.hook\";\nimport {TypeMessage} from \"../hooks/TypeMessage\";\nimport ReactMarkdown from 'react-markdown'\n\n\nconst Note = ({focus, setFocus, note, color, noteIndex, notes, setNotes, connection}) => {\n\n    const [changed, setChanged] = useState(false);\n    const [zIndex, setZIndex] = useState(1);\n    const [text, setText] = useState(note.text);\n    const {updateNote, isEqual} = useNote();\n\n    useEffect(function resetZIndex () {\n        setZIndex(0)\n        return () => {\n            setZIndex(0)\n        }\n    }, [])\n\n    useEffect(function liftingComponent (){\n        if (focus){\n            setZIndex(1)\n        } else {\n            setZIndex(0)\n        }\n    },[focus])\n\n    const updateStateNotes = (updatedNote) => {\n        setNotes(() => [...notes.filter(note => note.id !== updatedNote.id), updatedNote])\n    }\n    const sendNewPosition = (type, note) =>\n        connection.send(JSON.stringify({...note, type}))\n\n    const onDragStopHandler = (event, data) => {\n        if (note.x !== data.x && data.y !== note.y) {\n            const updatedNote = updateNote(note, {x: data.x, y: data.y});\n            sendNewPosition(TypeMessage.UPDATE, updatedNote)\n            updateStateNotes(updatedNote)\n        }\n    }\n\n    const onResizeStopHandler = (e, direction, ref, delta, position) => {\n        const updatedNote = updateNote(note, {\n            width: ref.style.width,\n            height: ref.style.height,\n            x: position.x,\n            y: position.y,\n        });\n        if (!isEqual(note, updatedNote)) {\n            updateStateNotes(updatedNote)\n            sendNewPosition(TypeMessage.UPDATE, updatedNote)\n        }\n    }\n\n    const deleteNoteHandler = () => {\n        sendNewPosition(TypeMessage.DELETE, note)\n        setNotes((prev) => [...prev.filter(noteFromState => noteFromState.id !== note.id)])\n    }\n\n    const changeColorHandler = (e) => {\n        const changeColor = e.target.value;\n        if (changeColor !== color) {\n            console.log(\"update color\")\n            const updatedNote = updateNote(note, {color: changeColor});\n            updateStateNotes(updatedNote)\n            sendNewPosition(TypeMessage.UPDATE, updatedNote)\n        }\n    }\n\n    const changeTextHandler = (e) => {\n        const text = e.target.value;\n        setText(text)\n    }\n\n    useEffect(function saveChangeText() {\n        if (!changed) {\n            const updatedNote = updateNote(note, {text});\n            updateStateNotes(updatedNote)\n            sendNewPosition(TypeMessage.UPDATE, updatedNote)\n        }\n    }, [changed])\n\n\n    return (\n        <Rnd\n            className=\"note\"\n            disableDragging={focus}\n            style={{zIndex: zIndex}}\n            size={{width: notes[noteIndex].width, height: notes[noteIndex].height}}\n            minWidth={250}\n            minHeight={250}\n            position={{x: notes[noteIndex].x, y: notes[noteIndex].y}}\n            onDragStop={onDragStopHandler}\n            onResizeStop={onResizeStopHandler}\n            bounds={\"window\"}\n        >\n            <div className=\"note-header\"\n                 style={{backgroundColor: color || \"gold\"}}\n                 onClick={() => setZIndex(1)}\n                 onMouseLeave={() => setZIndex(0)}\n            >\n                <div className=\"color-buttons\">\n                    <button className=\"btn blue\"\n                            value=\"blue\"\n                            onClick={changeColorHandler}\n                    />\n                    <button className=\"btn pink\"\n                            value=\"pink\"\n                            onClick={changeColorHandler}\n                    />\n                    <button className=\"btn yellow\"\n                            value=\"yellow\"\n                            onClick={changeColorHandler}\n                    />\n                </div>\n                <div className=\"cross\"\n                     onClick={deleteNoteHandler}\n                >\n                    &times;\n                </div>\n            </div>\n            {\n                changed\n                    ? (\n                        <textarea\n                            className=\"note-text\"\n                            value={text}\n                            onChange={changeTextHandler}\n                            autoFocus\n                            onBlur={() => {\n                                setChanged(false)\n                                setFocus(false)\n                            }}\n                        />\n\n                    )\n                    : (\n                        <div id=\"preview\"\n                             className=\"note-body\"\n                             onClick={() => {\n                                 setChanged(true)\n                                 setFocus(true)\n                             }}\n                        >\n                            <ReactMarkdown>\n                                {text}\n                            </ReactMarkdown>\n                        </div>\n                    )\n            }\n        </Rnd>\n    )\n}\n\nexport default Note"]},"metadata":{},"sourceType":"module"}