{"ast":null,"code":"var _jsxFileName = \"/home/deathsmell/WebstormProjects/i-note-common/src/App.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Rnd } from \"react-rnd\";\nimport update from 'immutability-helper';\nconst style = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  border: \"solid 1px #ddd\",\n  background: \"#f0f0f0\"\n};\n\nconst App = () => {\n  const [transformNote, setTransformNote] = useState(false);\n  const [text, setText] = useState('');\n  const rnd = useRef();\n  const [state, setState] = useState({\n    width: 200,\n    height: 200,\n    x: 0,\n    y: 0\n  });\n  useEffect(() => {\n    console.log(rnd.current.updatePosition);\n  }, [rnd]);\n\n  const savePositionWhenTransformation = () => {\n    console.log(\"change\", state.x !== 0);\n\n    if (state.x !== 0 || state.y !== 0) {\n      localStorage.setItem('position', JSON.stringify({\n        x: state.x,\n        y: state.y\n      }));\n      console.log(\"position\");\n      setState({ ...state,\n        x: 0,\n        y: 0\n      });\n    } else if (state.x === 0 && state.y === 0) {\n      const stringPosition = localStorage.getItem('position');\n\n      if (stringPosition) {\n        const {\n          x,\n          y\n        } = JSON.parse(stringPosition);\n        console.log(\"update \");\n        setState({ ...state,\n          x,\n          y\n        });\n      }\n    }\n  };\n\n  const getPositionIfRefreshPage = () => {\n    if (state.x === 0 && state.y === 0) {\n      const stringPosition = localStorage.getItem('position');\n\n      if (stringPosition) {\n        const {\n          x,\n          y\n        } = JSON.parse(stringPosition); // rnd.updatePosition({x,y})\n\n        setState({ ...state,\n          x,\n          y\n        });\n      }\n    }\n  };\n\n  useEffect(getPositionIfRefreshPage, []);\n  useEffect(savePositionWhenTransformation, [transformNote]);\n\n  const onDragStopHandler = (event, data) => {\n    setState(update(state, {\n      $merge: {\n        x: data.x,\n        y: data.y\n      }\n    }));\n  };\n\n  const onResizeStopHandler = (e, direction, ref, delta, position) => {\n    console.log(\"direction\", direction);\n    console.log(\"ref\", ref);\n    console.log('delta', delta);\n    console.log(\"position\", position);\n    setState({\n      width: ref.style.width,\n      height: ref.style.height,\n      ...position\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Rnd, {\n    ref: rnd,\n    className: `note${transformNote ? '-activate' : ''}`,\n    disableDragging: transformNote,\n    style: { ...style\n    },\n    size: {\n      width: state.width,\n      height: state.height\n    },\n    minWidth: 150,\n    minHeight: 150,\n    position: {\n      x: state.x,\n      y: state.y\n    },\n    onDragStop: onDragStopHandler,\n    onResizeStop: onResizeStopHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"color-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cross\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, \"\\xD7\")), transformNote ? /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"note-body\",\n    style: {\n      backgroundColor: \"grey\"\n    },\n    value: text,\n    onChange: e => setText(e.target.value),\n    onDoubleClick: () => setTransformNote(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-body\",\n    style: {\n      backgroundColor: 'grey'\n    },\n    onDoubleClick: () => setTransformNote(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 25\n    }\n  }, text));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/deathsmell/WebstormProjects/i-note-common/src/App.js"],"names":["React","useEffect","useRef","useState","Rnd","update","style","display","alignItems","justifyContent","border","background","App","transformNote","setTransformNote","text","setText","rnd","state","setState","width","height","x","y","console","log","current","updatePosition","savePositionWhenTransformation","localStorage","setItem","JSON","stringify","stringPosition","getItem","parse","getPositionIfRefreshPage","onDragStopHandler","event","data","$merge","onResizeStopHandler","e","direction","ref","delta","position","backgroundColor","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\"\nimport {Rnd} from \"react-rnd\"\nimport update from 'immutability-helper'\n\nconst style = {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    border: \"solid 1px #ddd\",\n    background: \"#f0f0f0\",\n};\n\nconst App = () => {\n\n    const [transformNote, setTransformNote] = useState(false);\n    const [text, setText] = useState('');\n    const rnd = useRef();\n\n    const [state, setState] = useState({\n        width: 200,\n        height: 200,\n        x: 0,\n        y: 0\n    });\n\n    useEffect(() => {\n        console.log(rnd.current.updatePosition)\n    }, [rnd])\n    const savePositionWhenTransformation = () => {\n        console.log(\"change\", state.x !== 0)\n        if (state.x !== 0 || state.y !== 0) {\n            localStorage.setItem('position', JSON.stringify({x: state.x, y: state.y}))\n            console.log(\"position\")\n            setState(\n                {...state, x: 0, y: 0}\n            )\n        } else if (state.x === 0 && state.y === 0) {\n            const stringPosition = localStorage.getItem('position');\n            if (stringPosition) {\n                const {x, y} = JSON.parse(stringPosition);\n                console.log(\"update \")\n                setState({\n                    ...state,\n                    x, y\n                })\n            }\n        }\n    };\n\n    const getPositionIfRefreshPage = () => {\n        if (state.x === 0 && state.y === 0) {\n            const stringPosition = localStorage.getItem('position');\n            if (stringPosition) {\n                const {x, y} = JSON.parse(stringPosition);\n                // rnd.updatePosition({x,y})\n                setState({\n                    ...state,\n                    x, y\n                })\n            }\n        }\n    }\n\n    useEffect(getPositionIfRefreshPage, [])\n    useEffect(savePositionWhenTransformation, [transformNote])\n\n\n    const onDragStopHandler = (event, data) => {\n        setState(update(state,\n            {$merge: {x: data.x, y: data.y}}\n            )\n        )\n    }\n\n    const onResizeStopHandler = (e, direction, ref, delta, position) => {\n        console.log(\"direction\", direction);\n        console.log(\"ref\", ref);\n        console.log('delta', delta)\n        console.log(\"position\", position);\n        setState({\n            width: ref.style.width,\n            height: ref.style.height,\n            ...position\n        });\n    }\n\n    return (\n        <Rnd\n            ref={rnd}\n            className={`note${transformNote ? '-activate' : ''}`}\n            disableDragging={transformNote}\n            style={{...style}}\n            size={{width: state.width, height: state.height}}\n            minWidth={150}\n            minHeight={150}\n            position={{x: state.x, y: state.y}}\n            onDragStop={onDragStopHandler}\n            onResizeStop={onResizeStopHandler}\n        >\n            <div className=\"note-header\">\n                <div className=\"color-buttons\">\n                    <button className=\"btn btn-success\"/>\n                    <button className=\"btn btn-danger\"/>\n                    <button className=\"btn btn-secondary\"/>\n                </div>\n                <div className=\"cross\">\n                    &times;\n                </div>\n            </div>\n            {\n                transformNote\n                    ?\n                    (\n                        <textarea\n                            className=\"note-body\"\n                            style={{backgroundColor: \"grey\"}}\n                            value={text}\n                            onChange={(e) => setText(e.target.value)}\n                            onDoubleClick={() => setTransformNote(false)}\n                        >\n\n                            </textarea>\n                    )\n                    : (\n                        <div className=\"note-body\"\n                             style={{backgroundColor: 'grey'}}\n                             onDoubleClick={() => setTransformNote(true)}\n                        >\n                            {text}\n                        </div>\n                    )\n            }\n        </Rnd>\n    )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}