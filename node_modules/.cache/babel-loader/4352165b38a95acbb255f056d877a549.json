{"ast":null,"code":"var _jsxFileName = \"/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Rnd } from \"react-rnd\";\nimport useNote from \"../hooks/note.hook\";\nimport useLocal from \"../hooks/local.hook\";\nimport { TypeMessage } from \"../hooks/TypeMessage\";\nconst style = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  border: \"solid 1px #ddd\",\n  background: \"#f0f0f0\"\n};\n\nconst Note = ({\n  note,\n  noteIndex,\n  height,\n  width,\n  x,\n  y,\n  noteId,\n  color,\n  serverText,\n  notes,\n  setNotes\n}) => {\n  const rnd = useRef();\n  const [transformNote, setTransformNote] = useState(false);\n  const [text, setText] = useState(serverText);\n  const {\n    removeInLocal,\n    saveInLocal,\n    getFromLocal\n  } = useLocal();\n  const {\n    updateNote\n  } = useNote();\n\n  const getNote = () => notes.find(note => note.id === noteId);\n\n  const getNoteIndex = () => notes.findIndex(note => note.id === noteId);\n\n  const updateStateNotes = (index, updatedNote) => {\n    notes[index] = updatedNote;\n    setNotes([...notes]);\n  };\n\n  const updateState = (width, height, x, y) => {\n    let newState = [...notes];\n    newState[noteIndex] = {\n      width: width || notes[noteIndex].width,\n      height: height || notes[noteIndex].height,\n      x: ~x ? x : notes[noteIndex].x,\n      y: ~y ? y : notes[noteIndex].y\n    };\n    return newState;\n  }; // const sendNewPosition = (type, note) => connection.send(JSON.stringify({...note, type}))\n\n\n  useEffect(function watchMounting() {\n    console.log(\"mounted\");\n    return () => {\n      console.log(\"unmounted\");\n    };\n  }, []);\n  useEffect(function savePositionWhenTransformation() {\n    console.log('save position');\n\n    if (transformNote && (x !== 0 || y !== 0)) {\n      const updatedNote = updateNote(note, {\n        x,\n        y\n      });\n      saveInLocal(noteId, updatedNote);\n      updateStateNotes(noteIndex, { ...note,\n        x: 0,\n        y: 0\n      });\n    } else if (x === 0 && y === 0) {\n      const stringPosition = getFromLocal(noteId);\n\n      if (stringPosition) {\n        const updatedNote = updateNote(note, {\n          width: stringPosition.width,\n          height: stringPosition.height,\n          x: stringPosition.x,\n          y: stringPosition.y\n        });\n        setNotes(updatedNote);\n      }\n    }\n  }, [transformNote]);\n\n  const onDragStopHandler = (event, data) => {\n    const newState = updateState(null, null, data.x, data.y);\n    console.log(newState);\n    setNotes(newState);\n  };\n\n  const onResizeStopHandler = (e, direction, ref, delta, position) => {\n    const updatedNote = updateNote(note, {\n      width: ref.style.width,\n      height: ref.style.height,\n      x: position.x,\n      y: position.y\n    });\n    console.log(\"Compare\", note, updatedNote);\n    updateStateNotes(noteIndex, updatedNote);\n  };\n\n  const deleteNoteHandler = () => {\n    // todo: create delete function on cross icon\n    console.log(\"Nothing to do\");\n  };\n\n  return /*#__PURE__*/React.createElement(Rnd, {\n    ref: rnd,\n    className: `note${transformNote ? '-activate' : ''}`,\n    disableDragging: transformNote,\n    style: { ...style\n    },\n    size: {\n      width: notes[noteIndex].width,\n      height: notes[noteIndex].height\n    },\n    minWidth: 250,\n    minHeight: 250,\n    position: {\n      x: notes[noteIndex].x,\n      y: notes[noteIndex].y\n    },\n    onDragStop: onDragStopHandler,\n    onResizeStop: onResizeStopHandler,\n    bounds: \"window\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"color-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cross\",\n    onClick: deleteNoteHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }\n  }, \"\\xD7\")), transformNote ? /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"note-text\",\n    style: {\n      backgroundColor: color || \"grey\"\n    },\n    value: text,\n    onChange: e => setText(e.target.value),\n    onDoubleClick: () => setTransformNote(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"note-body\",\n    style: {\n      backgroundColor: color || \"grey\"\n    },\n    onDoubleClick: () => setTransformNote(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }\n  }, text));\n};\n\nexport default Note;","map":{"version":3,"sources":["/home/deathsmell/WebstormProjects/i-note-common/src/components/Note.js"],"names":["React","useEffect","useRef","useState","Rnd","useNote","useLocal","TypeMessage","style","display","alignItems","justifyContent","border","background","Note","note","noteIndex","height","width","x","y","noteId","color","serverText","notes","setNotes","rnd","transformNote","setTransformNote","text","setText","removeInLocal","saveInLocal","getFromLocal","updateNote","getNote","find","id","getNoteIndex","findIndex","updateStateNotes","index","updatedNote","updateState","newState","watchMounting","console","log","savePositionWhenTransformation","stringPosition","onDragStopHandler","event","data","onResizeStopHandler","e","direction","ref","delta","position","deleteNoteHandler","backgroundColor","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\"\nimport {Rnd} from \"react-rnd\"\nimport useNote from \"../hooks/note.hook\";\nimport useLocal from \"../hooks/local.hook\";\nimport {TypeMessage} from \"../hooks/TypeMessage\";\n\nconst style = {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    border: \"solid 1px #ddd\",\n    background: \"#f0f0f0\",\n};\n\nconst Note = ({note,noteIndex,height, width, x, y, noteId, color, serverText, notes, setNotes}) => {\n\n\n    const rnd = useRef();\n    const [transformNote, setTransformNote] = useState(false);\n    const [text, setText] = useState(serverText);\n    const {removeInLocal, saveInLocal, getFromLocal} = useLocal();\n    const {updateNote} = useNote();\n\n    const getNote = () => notes.find(note => note.id === noteId)\n    const getNoteIndex = () => notes.findIndex(note => note.id === noteId)\n    const updateStateNotes = (index,updatedNote) => {\n        notes[index] = updatedNote\n        setNotes([...notes])\n    }\n\n    const updateState = (width,height,x,y) => {\n        let newState = [...notes]\n        newState[noteIndex] = {\n            width: width || notes[noteIndex].width,\n            height: height || notes[noteIndex].height,\n            x: ~x ? x : notes[noteIndex].x,\n            y: ~y ? y : notes[noteIndex].y,\n        }\n        return newState\n    }\n    // const sendNewPosition = (type, note) => connection.send(JSON.stringify({...note, type}))\n\n\n    useEffect(function watchMounting() {\n        console.log(\"mounted\")\n        return () => {\n            console.log(\"unmounted\")\n        }\n    }, [])\n\n\n    useEffect(function savePositionWhenTransformation() {\n        console.log('save position')\n        if (transformNote && (x !== 0 || y !== 0)) {\n            const updatedNote = updateNote(note, {x, y});\n            saveInLocal(noteId, updatedNote)\n            updateStateNotes(noteIndex,{...note, x: 0, y: 0});\n        } else if (x === 0 && y === 0) {\n            const stringPosition = getFromLocal(noteId)\n            if (stringPosition) {\n                const updatedNote = updateNote(note, {\n                    width: stringPosition.width,\n                    height: stringPosition.height,\n                    x: stringPosition.x,\n                    y: stringPosition.y\n                });\n                setNotes(updatedNote)\n            }\n        }\n    }, [transformNote])\n\n\n    const onDragStopHandler = (event, data) => {\n        const newState = updateState(null,null,data.x,data.y);\n        console.log(newState);\n        setNotes(newState)\n    }\n\n    const onResizeStopHandler = (e, direction, ref, delta, position) => {\n        const updatedNote = updateNote(note, {\n            width: ref.style.width,\n            height: ref.style.height,\n            x: position.x,\n            y: position.y\n        });\n        console.log(\"Compare\", note,updatedNote)\n        updateStateNotes(noteIndex,updatedNote)\n    }\n\n    const deleteNoteHandler = () => {\n        // todo: create delete function on cross icon\n        console.log(\"Nothing to do\")\n    }\n\n    return (\n        <Rnd\n            ref={rnd}\n            className={`note${transformNote ? '-activate' : ''}`}\n            disableDragging={transformNote}\n            style={{...style}}\n            size={{width: notes[noteIndex].width, height: notes[noteIndex].height}}\n            minWidth={250}\n            minHeight={250}\n            position={{x: notes[noteIndex].x, y: notes[noteIndex].y}}\n            onDragStop={onDragStopHandler}\n            onResizeStop={onResizeStopHandler}\n            bounds={\"window\"}\n        >\n            <div className=\"note-header\">\n                <div className=\"color-buttons\">\n                    <button className=\"btn btn-success\"/>\n                    <button className=\"btn btn-danger\"/>\n                    <button className=\"btn btn-secondary\"/>\n                </div>\n                <div className=\"cross\"\n                     onClick={deleteNoteHandler}\n                >\n                    &times;\n                </div>\n            </div>\n            {\n                transformNote\n                    ?\n                    (\n                        <textarea\n                            className=\"note-text\"\n                            style={{backgroundColor: color || \"grey\"}}\n                            value={text}\n                            onChange={(e) => setText(e.target.value)}\n                            onDoubleClick={() => setTransformNote(false)}\n                        >\n\n                            </textarea>\n                    )\n                    : (\n                        <div className=\"note-body\"\n                             style={{backgroundColor: color || \"grey\"}}\n                             onDoubleClick={() => setTransformNote(true)}\n                        >\n                            {text}\n                        </div>\n                    )\n            }\n        </Rnd>\n    )\n}\n\nexport default Note"]},"metadata":{},"sourceType":"module"}